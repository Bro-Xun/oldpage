// JavaScript Document
var dat=[];
window.onload = function(){
	const zone = new AV.Query('Zone');
	zone.equalTo('author', 'Hydi');
	zone.limit(1000);
	zone.find().then((det) => {
		for (var i = 0; i < det.length; i++){
			var object = det[i].attributes;
			//var id=det[i].id
			var obj={author:object["author"],content:object["content"].replace(/'/g,"‘"),copyright:object["copyright"],edit_time:object["edit_time"],forward:object["forward"],tags: object["tags"],timestamp:object["timestamp"],title:object["title"].replace(/'/g,"‘"),views:object["views"],id:det[i].id}
			dat.push(obj)
		}
		//console.log(det);
		console.log(dat);
	});
}
function newpage(title,author,content,copyright,forward,edit_time,tags,timestamp,views,ObjId){
	const clickscount = AV.Object.createWithoutData('Zone', ObjId);
	clickscount.increment('views',1);
	clickscount.save();
	nwin = window.open("");
	nwin.document.write("<html lang='zh-CN'><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=no'><link rel='icon' href='https://img.wenhairu.com/image/GRE4u'><style>body{margin: 0;}*{-webkit-tap-highlight-color: transparent;}::selection {color: #00e9e9;background: rgba(255,147,182,.70);}#rin-bg{top: 0;left: 0;right: 0;bottom: 0;z-index: -2;position: fixed;background-size: cover;background-repeat: no-repeat;background-attachment: fixed;background-position: 50% 50%;background-color: #818181;}#rin-bg:after {top: 0;left: 0;right: 0;bottom: 0;content: '';z-index: -1;position: fixed;background-color: rgba(66,66,66,.6);}#rin-footer {bottom: 0;margin: auto;width: 100vw;position: absolute;padding: 10px 0 10px 0;}#rin-footer div {font-size: 14px;text-align: center;color: rgba(255,255,255,.79);}#rin-footer div a {color: #2196f3;font-weight: 700;transition: all .3s;text-decoration: none;}.rin-tr {width: 70%;height: 2px;margin:auto;background: rgba(255,255,255,.3);}mark{background-image: linear-gradient(#eacf1336, #ffe21dad);background-color: transparent;background-position: 0 85%;background-size: 100% 25%;background-repeat: no-repeat;color: var(--routine);}#rin-main{display: flex;justify-content: flex-start;width: 95%;margin: auto;height: 100vh;max-width: 1200px;flex-flow: column nowrap;}@media(max-height:777px){#rin-main {height: auto;}}.rin-card{margin: 10px 0;padding:15px 25px;padding-bottom:0;background-color: rgba(255,64,129,0.25);border-radius:40px;}.rin-card-title{font-size: 30px;color:white;margin-bottom: 15px;}.rin-card-title2{font-size: 20px;color:white;margin-bottom: 5px;}.rin-card-content{font-size: 17px;color:white;margin-bottom: 5px;line-height:1.5;}.rin-card-content-s{font-size: 0.5px;color:white;margin-bottom: 0px;line-height:1;}.rin-card-title2 a{text-decoration:none;}.rin-card-part{margin-bottom: 15px;margin-top: 10px;}.mdui-progress{background-color: rgba(255,255,255,.2)!important;}.mdui-progress-determinate{background-color: rgb(255,255,255)!important;}.mdui-tooltip{margin-top:10px!important;}.rin-btn {color:white;margin-right: 10px;min-width:100px!important;@media only screen and (min-width: 321px) and (max-width: 1024px) {.rin-btn {margin-bottom: 10px;}}.rin-btn-blue{border-bottom: 1.5px solid #28A9E0;}.rin-btn-blue:hover{background-color: #28A9E0;transition: all .3s;}.rin-btn-pink{border-bottom: 1.5px solid #F9A2A8;}.rin-btn-pink:hover{background-color: #F9A2A8;transition: all .3s;}.rin-btn-black{border-bottom: 1.5px solid #353535;}.rin-btn-black:hover{background-color: #353535;transition: all .3s;}.rin-tr{margin-top:5px;margin-bottom:15px;}#last {text-align: center;}#last .rin-card-title2{letter-spacing : 10px;margin-bottom: 10px;}#last .rin-card-content{font-size: 12px;letter-spacing: 1em;opacity: .5;}#footer{text-align: center;}#footer .rin-card-content{font-size: 12px;opacity: .5;}#footer div a {font-weight: 700;text-decoration: none;}mark{background-image: linear-gradient(#eacf1336, #ffe21dad);background-color: transparent;background-position: 0 85%;background-size: 100% 25%;background-repeat: no-repeat;color: var(--routine);}a:hover{color:white}a:active{color:gray}a:link{color:white}a:visited{color:white}p{margin-bottom: 1cm;color: aliceblue;margin-left: 20px;margin-right: 20px}</style><style>h1,h2,h3,h4,h5,h6,blockquote{margin:0;padding:0;color:white}body{font-family:'Helvetica Neue',Helvetica,'Hiragino Sans GB',Arial,sans-serif;font-size:13px;line-height:18px;color:white;background-color:white;margin:10px 13px 10px 13px}table{margin:10px 0 15px 0;border-collapse:collapse}td,th{border:1px solid #ddd;padding:3px 10px}th{padding:5px 10px}a:hover{text-decoration:none}a img{border:0}p{margin-bottom:9px}h1,h2,h3,h4,h5,h6{color:white;line-height:36px}h1{margin-bottom:18px;font-size:30px}h2{font-size:24px}h3{font-size:18px}h4{font-size:16px}h5{font-size:14px}p{color:white}h6{font-size:13px}hr{margin:0 0 19px;border:0;border-bottom:1px solid #ccc}blockquote{line-height:26px;margin-bottom:18px;background:#474747;border-left:5px solid #50bfff;color:#50bfff;padding:8px 15px;border-radius:0 var(--radius-inner) var(--radius-inner) 0}blockquote p{font-size:14px;font-weight:300;line-height:18px;margin-bottom:0;font-style:italic}code,pre{font-family:Monaco,Andale Mono,Courier New,monospace}code{background-color:#fee9cc;color:rgba(0,0,0,0.75);padding:1px 3px;font-size:12px;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px}pre{display:block;padding:14px;margin:0 0 18px;line-height:16px;font-size:11px;border:1px solid #d9d9d9;white-space:pre-wrap;word-wrap:break-word}pre code{background-color:#fff;color:#737373;font-size:11px;padding:0}sup{font-size:.83em;vertical-align:super;line-height:0}*{-webkit-print-color-adjust:exact}@media screen and (min-width:914px){body{width:854px;margin:10px auto}}@media print{body,code,pre code,h1,h2,h3,h4,h5,h6{color:black}table,pre{page-break-inside:avoid}}</style></head><body class='mdui-theme-primary-pink mdui-theme-accent-pink' height='100%'><div id='rin-bg'></div><main id='rin-main'><div class='mdui-card rin-card'><div style='text-align: center;font-weight: bold;font-size: 30px;color:aliceblue;margin:1.5rem 0 2rem 0' id='title'>此处应有标题</div><div id='detailedinfo' align='center' style='color: aliceblue;margin:0.5rem 0 0 1.5rem' id='info'>详细信息保留地</div><div class='rin-tr'></div><div id='content'><p>此处是段落一</p><p>此处是段落二</p></div><div class='rin-tr'></div><div class='rin-card-part' id='footer'><div class='rin-card-content'>©2021 Hydi | Made with love by <a href='tel:1145141919810'>Hydroxyl ion</a> | BG: <a='https://www.pixiv.net/artworks/56652667' target='_blank'>Pixiv</a></div></div></div></main><script>var Xp;var Yp;document.onmousedown=function(e){Xp=e.clientX;Yp=e.clientY;}</script><script>var box=false;var body=document.getElementsByTagName('body')[0];var textArr=['有你真好~','(*^▽^*)','爱你~','可爱~'];var colorArr=['red','deeppink','lightgreen','purple','yellow','orange','aqua']document.addEventListener('click',(e)=>{var ev=e||window.event;var baseX=ev.clientX;var baseY=ev.clientY;var new_span=document.createElement('span');new_span.innerText=textArr[parseInt(Math.random()*textArr.length)];new_span.style.position='fixed';new_span.style.left=baseX-10+'px';new_span.style.top=baseY+'px';new_span.style.color=colorArr[parseInt(Math.random()*colorArr.length)];body.appendChild(new_span);var timer=window.setInterval(()=>{new_span.style.top=parseInt(window.getComputedStyle(new_span,null)['top'])-2+'px';new_span.style.opacity=window.getComputedStyle(new_span,null)['opacity']-0.02;},30);window.setTimeout(()=>{window.clearInterval(timer);body.removeChild(new_span);},1000);},false);</script></body></html>");
	nwin.document.title="Hydi"+" : "+title;//
	nwin.document.getElementById("title").innerHTML=title.replace(/‘/g,"'");
	nwin.document.getElementById("detailedinfo").innerHTML="作者: "+author+" "+"标签: "+tags+" "+"时间: "+Math.floor((edit_time)/6000)/10+"分钟"+" "+"日期: "+getLocalTime(timestamp)+" "+views+"阅读（重复统计）"
	nwin.document.getElementById("content").innerHTML=content.replace(/\$endl\$/g,"").replace(/‘/g,"'");
	nwin.focus();
}
function showall(){
		document.getElementById("details").innerHTML="";
		console.log("cleared")
	for(var i=0;i<dat.length;i++){	
		document.getElementById("details").innerHTML=document.getElementById("details").innerHTML+"<a OnClick='newpage(\""+dat[i].title+'\",\"'+dat[i].author+'\",\"'+dat[i].content.replace(/\n/g,"$endl$")+'\",'+dat[i].copyright+','+dat[i].forward+','+dat[i].edit_time+',\"'+dat[i].tags.toString().replace(/,/g," | ")+'\",'+dat[i].timestamp+','+dat[i].views+",\""+dat[i].id+"\")'><div class='mdui-card rin-card rin-card-article' style='margin-bottom: 5px;'><div class='rin-article-title'>"+dat[i].title+"</div><div class='rin-article-content'>"+dat[i].content.replace(/\n/g,"").replace(/<[^>]+>/g," ").substring(0,35)+"...</div><div class='rin-article-content'>"+getLocalTime(dat[i].timestamp)+"</div></div></a>";
		console.log("item "+i+" pushed: succeed!");
	}
}
function getLocalTime(mS) {     
   return new Date(parseInt(mS)).toLocaleString('chinese',{hour12:false}).replace(/:\d{1,2}$/,' ');     
}
